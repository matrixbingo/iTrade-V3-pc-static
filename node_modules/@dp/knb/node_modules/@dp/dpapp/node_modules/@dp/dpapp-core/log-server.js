var http = require('http');


function getIP(){
  var os = require('os');
  var ifaces = os.networkInterfaces();
  var ips = [];
  Object.keys(ifaces).forEach(function (ifname) {
    var alias = 0
      ;

    ifaces[ifname].forEach(function (iface) {
      if ('IPv4' !== iface.family || iface.internal !== false) {
        // skip over internal (i.e. 127.0.0.1) and non-ipv4 addresses
        return;
      }

      if (alias >= 1) {
        iface.address.forEach(function(ip){
          ips.push(ip);
        });
      } else {
        ips.push(iface.address);
      }
    });
  });

  return ips[0];
}

var server = http.createServer(function(req,res){
  console.log( decodeURIComponent(req.url) );

  res.end("");
});

var ip = getIP();

server.listen(8000);

console.log("server started at http://" + ip);