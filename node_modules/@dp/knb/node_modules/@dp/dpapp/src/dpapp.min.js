(function(a){var b={};function c(e){if(b[e]){return b[e].exports}var d=b[e]={exports:{},id:e,loaded:false};a[e].call(d.exports,d,d.exports,c);d.loaded=true;return d.exports}c.m=a;c.c=b;c.p="";return c(0)})([function(b,a,c){(function(f){var e=c(1);var d=c(20);var g=c(21);c(22);var h=function(i,j){if(e.Semver.gte(d.appVersion,i)){e.patchForType(d.appVersion,j)}};h("7.0.0",c(23));h("7.1.0",c(24));h("7.2.0",c(25));h("7.5.0",c(26));h("7.6.0",c(27));h("7.8.0",c(28));h("7.9.1",c(29));h("7.9.4",c(31));h("7.9.6",c(32));h("8.0.0",c(33));h("8.0.4",c(34));e.apis=g;e.decorate();g.forEach(function(i){if(!e[i]){e[i]=e._notImplemented}});if(true){b.exports=e}if(typeof f!=="undefined"){if(f.DPApp){e._mixin(f.DPApp,e)}else{f.DPApp=e}}}(window))},function(f,e,g){var h=g(2);var d=g(19);var c=g(20);var a=function(){};var b=f.exports=new h({hippoPrefix:"dpapp",getTypeFromUA:c.getWebviewVersion,apis:[],allowBeforeReady:["getRequestId"],isOldVersion:function(){return this.uaType()=="6.9.x"},cache:{},Share:{WECHAT_FRIENDS:0,WECHAT_TIMELINE:1,QQ:2,SMS:3,WEIBO:4,QZONE:5,EMAIL:6,COPY:7},_tidyUrlParams:function(k){var l=k.split("?");var j=l[1];var i=[];if(!j){return l[0]}else{j.split("&").forEach(function(n){var m=n.split("=")[0];if(!/^(newtoken|token)$/.test(m)){i.push(n)}});return[l[0],i.join("&")].join("?")}},_getEnv:function(j){var i=this;this._doSendMessage("getEnv",{},function(k){i.cache["env"]=k;j.call(this,k)})},_captal:function(i){return i.slice(0,1).toUpperCase()+i.slice(1)},_getBizName:function(j){var i=j.fail;var k=this._cfg.bizname;if(!k){i&&i('use `DPApp.config({bizname:"<your-bizname>"})` first');return false}else{return k}},isStatusOK:a,did_handle_callback:a,_doSendMessage:function(i,m,p){var q=this;var k=p&&typeof p=="function";this.log("调用方法",i,m);var j=k?this._generateCallbackId():0;var o=this._generateCallbackName(j);if(k){window[o]=p}if(!m||typeof m!=="object"){m={}}m.callbackId=j;m=JSON.stringify(m);var n=window._DPApp;var l="js://_?method="+i+"&args="+encodeURIComponent(m)+"&callbackId="+j;this.log("创建iframe "+i,"callbackId:"+j);if(i==="getCX"){b._getCXTimeout=setTimeout(function(){window[o]({status:"fail",msg:"Timeout"})},1000)}this._createIframe(l)},_send:function(i,m){m=m||{};var q=this;var n=m.success;var r=m.fail;var j=m.handle;var k=function(s){q.log("调用失败 "+i,s);r&&r.call(q,s)};var p=function(s){q.log("调用成功 "+i,s);n&&n.call(q,s)};var l=function(s){q.log("回调 "+i,s);j&&j.call(q,s)};var o=(n||r||j)?function(s){var t=s.status;if(s.result!="next"){delete s.result}if(t=="success"){if(i==="getCX"){clearTimeout(b._getCXTimeout);b._getCXTimeout=null}p&&p(s)}else{if(t=="action"){l&&l(s)}else{k&&k(s)}}}:null;this._sendMessage(i,m,o)},});if(window.DPApp){b=d(window.DPApp,b)}},function(d,b,f){var g=f(3);var a=f(16);var c=f(18);var e=f(6);g.prototype._mixin(g.prototype,a);g.prototype._mixin(g.prototype,c);g.prototype.all=function(h){return e.all(h)};d.exports=g},function(c,b,e){function a(i,h){for(var g in h){i[g]=h[g]}return i}var f=c.exports=function(h){h=h||{};var g=this;for(var j in h){this[j]=h[j]}var i=h.apis||e(4);(h.extraApis||[]).forEach(function(k){if(i.indexOf(k)===-1){i.push(k)}});this.apis=i;this.allowBeforeReady=this.allowBeforeReady||["getRequestId"];i.forEach(function(k){if(!g[k]){g[k]=function(l){g._send(k,l)}}});this.decorate()};f.prototype={_cfg:{debug:false},_isProduct:!!location.href.match(".dianping.com"),_isReady:false,config:function(g){for(var h in g){this._cfg[h]=g[h]}},isOldVersion:function(){return false},getQuery:function(){var h=location.search.slice(1);var g={};h.split("&").forEach(function(i){var j=i.split("=");g[j[0]]=j[1]});return g},patchForType:function(g,h){if(this.uaType()==g){this.extend(h);this.decorate()}},decorate:e(5),Semver:{eq:function(h,g){return h===g},gt:function(h,g){var j=h?h.split("."):[];var i=g?g.split("."):[];[0,1,2].forEach(function(k){j[k]=j[k]||0;i[k]=i[k]||0});if(+j[0]!==+i[0]){return +j[0]>+i[0]}else{if(+j[1]!==+i[1]){return +j[1]>+i[1]}else{return +j[2]>+(i[2]||0)}}},lt:function(h,g){return !this.gte(h,g)},gte:function(h,g){return this.eq(h,g)||this.gt(h,g)},lte:function(h,g){return this.eq(h,g)||this.lt(h,g)}},_parseUA:function(g){var h,j,i;if(g.match(/iPhone/)){h="iphone";j=g.match(/iPhone\sOS\s([\d_]+)/i)[1].replace(/_/g,".")}else{if(g.match(/Android/)){h="android";i=g.match(/Android[\s|\/]([\w\.]+)/);j=i&&i[1]}else{h=null;j=null}}return{name:h,version:j}},getTypeFromUA:function(g){return/dp\/com\.dianping\.(\w+)\//.test(g)?g.match(/dp\/com\.dianping\.(\w+)\//)[1]:"web"},uaType:function(){return this.getTypeFromUA(navigator.userAgent)},_trace:function(h,i){if(!this.hippoPrefix){return}var g=(this._cfg&&this._cfg.logFact)||0.05;i=i||{};i=this._mixin(i,{module:this.hippoPrefix+"_"+h});if(Math.random()<g){console.log("_trace",h);window._hip&&_hip.push(["mv",i])}},log:function(){var h=[];for(var g=0;g<arguments.length;g++){if(typeof arguments[g]=="string"){h.push(arguments[g])}else{if(arguments[g]!=undefined){h.push(JSON.stringify(arguments[g]))}}}h=h.join(" ");if(this._cfg&&this._cfg.debug){setTimeout(function(){alert(h)
})}else{console.log(h)}},_mixin:a,extend:function(g){return this._mixin(this,g)},_notImplemented:function d(g){g&&g.fail&&g.fail({errMsg:"ERR_NOT_IMPLEMENTED"})},isSupport:function(h){var g=this[h];return !!(g&&typeof g=="function"&&g!=this._notImplemented&&g._notReady!=true)}};f.prototype._osUA=f.prototype._parseUA(navigator.userAgent)},function(b,a){b.exports=["getVersion","getNetworkType","getContactList","pickContact","getRequestId","getDeviceInfo","clearStorage","store","retrieve","publish","subscribe","unsubscribe","openScheme","jumpToScheme","closeWindow","sendSMS","downloadImage","setBackgroundColor","setTitle","setLLButton","setLRButton","setRLButton","setRRButton","isInstalledApp","alert","prompt","confirm","actionSheet"]},function(b,a,d){var c=d(6);b.exports=function(e){var g=this;var f=this.apis;var e=this.allowBeforeReady;f.forEach(function(h){if(!g[h]){g[h]=g._notImplemented}});f.forEach(function(h){var i=g[h];if(g[h]&&g[h]._decorated){return}g[h]=function(k){var j=g._mixin({},k);g._trace(h+"_call");var n=j.success;var o=j.fail;var l=function(p){if(!o){if(g.onerror){g.onerror({api:h,err:p})}else{var q=p.errMsg?p.errMsg:JSON.stringify(p);var r=new Error(q);r.name="DPAppError";console.warn("`DPApp."+h+"` call faild");g._trace("throw");console.warn(new Error(r))}}else{o(p)}};var m=+new Date;j.success=function(p){g._trace(h+"_success",{time:+new Date-m,});n&&n(p)};j.fail=function(p){var q={};q.args=k;q.result=p;g._trace(h+"_fail",{time:+new Date-m,note:JSON.stringify(q)});l(p)};if(!this._isReady&&e.indexOf(h)===-1&&!g._isProduct&&g.isOldVersion()){l("use `DPApp.ready(fn)` to wrap api calls");return}return new c(function(s,r){var u=j.success;var p=j.fail;var t=function(v){u(v);s(v)};var q=function(v){p(v);if(!o){r(v)}};j.success=t;j.fail=q;i.call(g,j)})};g[h]._decorated=true;g[h]._notReady=i==g._notImplemented})}},function(b,a,c){b.exports=c(7)},function(b,a,c){b.exports=c(8);c(10);c(11);c(12);c(13);c(15)},function(b,r,c){var m=c(9);function e(){}var g=null;var s={};function i(u){try{return u.then}catch(t){g=t;return s}}function q(v,t){try{return v(t)}catch(u){g=u;return s}}function k(w,u,t){try{w(u,t)}catch(v){g=v;return s}}b.exports=d;function d(t){if(typeof this!=="object"){throw new TypeError("Promises must be constructed via new")}if(typeof t!=="function"){throw new TypeError("not a function")}this._45=0;this._81=0;this._65=null;this._54=null;if(t===e){return}h(t,this)}d._10=null;d._97=null;d._61=e;d.prototype.then=function(v,t){if(this.constructor!==d){return a(this,v,t)}var u=new d(e);o(this,new l(v,t,u));return u};function a(t,v,u){return new t.constructor(function(y,x){var w=new d(e);w.then(y,x);o(t,new l(v,u,w))})}function o(u,t){while(u._81===3){u=u._65}if(d._10){d._10(u)}if(u._81===0){if(u._45===0){u._45=1;u._54=t;return}if(u._45===1){u._45=2;u._54=[u._54,t];return}u._54.push(t);return}j(u,t)}function j(u,t){m(function(){var v=u._81===1?t.onFulfilled:t.onRejected;if(v===null){if(u._81===1){n(t.promise,u._65)}else{f(t.promise,u._65)}return}var w=q(v,u._65);if(w===s){f(t.promise,g)}else{n(t.promise,w)}})}function n(t,u){if(u===t){return f(t,new TypeError("A promise cannot be resolved with itself."))}if(u&&(typeof u==="object"||typeof u==="function")){var v=i(u);if(v===s){return f(t,g)}if(v===t.then&&u instanceof d){t._81=3;t._65=u;p(t);return}else{if(typeof v==="function"){h(v.bind(u),t);return}}}t._81=1;t._65=u;p(t)}function f(t,u){t._81=2;t._65=u;if(d._97){d._97(t,u)}p(t)}function p(t){if(t._45===1){o(t,t._54);t._54=null}if(t._45===2){for(var u=0;u<t._54.length;u++){o(t,t._54[u])}t._54=null}}function l(v,t,u){this.onFulfilled=typeof v==="function"?v:null;this.onRejected=typeof t==="function"?t:null;this.promise=u}function h(v,w){var t=false;var u=k(v,function(x){if(t){return}t=true;n(w,x)},function(x){if(t){return}t=true;f(w,x)});if(!t&&u===s){t=true;f(w,g)}}},function(b,a){(function(e){b.exports=j;function j(n){if(!g.length){m();f=true}g[g.length]=n}var g=[];var f=false;var m;var i=0;var c=1024;function l(){while(i<g.length){var n=i;i=i+1;g[n].call();if(i>c){for(var o=0,p=g.length-i;o<p;o++){g[o]=g[o+i]}g.length-=i;i=0}}g.length=0;i=0;f=false}var k=e.MutationObserver||e.WebKitMutationObserver;if(typeof k==="function"){m=d(l)}else{m=h(l)}j.requestFlush=m;function d(r){var n=1;var p=new k(r);var q=document.createTextNode("");p.observe(q,{characterData:true});return function o(){n=-n;q.data=n}}function h(o){return function n(){var p=setTimeout(q,0);var r=setInterval(q,50);function q(){clearTimeout(p);clearInterval(r);o()}}}j.makeRequestCallFromTimer=h}.call(a,(function(){return this}())))},function(b,a,d){var c=d(8);b.exports=c;c.prototype.done=function(g,f){var e=arguments.length?this.then.apply(this,arguments):this;e.then(null,function(h){setTimeout(function(){throw h},0)})}},function(b,a,d){var c=d(8);b.exports=c;c.prototype["finally"]=function(e){return this.then(function(f){return c.resolve(e()).then(function(){return f})},function(f){return c.resolve(e()).then(function(){throw f})})}
},function(b,e,a){var j=a(8);b.exports=j;var c=k(true);var h=k(false);var d=k(null);var g=k(undefined);var f=k(0);var i=k("");function k(l){var m=new j(j._61);m._81=1;m._65=l;return m}j.resolve=function(m){if(m instanceof j){return m}if(m===null){return d}if(m===undefined){return g}if(m===true){return c}if(m===false){return h}if(m===0){return f}if(m===""){return i}if(typeof m==="object"||typeof m==="function"){try{var n=m.then;if(typeof n==="function"){return new j(n.bind(m))}}catch(l){return new j(function(p,o){o(l)})}}return k(m)};j.all=function(l){var m=Array.prototype.slice.call(l);return new j(function(r,q){if(m.length===0){return r([])}var p=m.length;function o(s,v){if(v&&(typeof v==="object"||typeof v==="function")){if(v instanceof j&&v.then===j.prototype.then){while(v._81===3){v=v._65}if(v._81===1){return o(s,v._65)}if(v._81===2){q(v._65)}v.then(function(w){o(s,w)},q);return}else{var u=v.then;if(typeof u==="function"){var t=new j(u.bind(v));t.then(function(w){o(s,w)},q);return}}}m[s]=v;if(--p===0){r(m)}}for(var n=0;n<m.length;n++){o(n,m[n])}})};j.reject=function(l){return new j(function(n,m){m(l)})};j.race=function(l){return new j(function(n,m){l.forEach(function(o){j.resolve(o).then(n,m)})})};j.prototype["catch"]=function(l){return this.then(null,l)}},function(d,c,g){var f=g(8);var a=g(14);d.exports=f;f.denodeify=function(i,j){if(typeof j==="number"&&j!==Infinity){return h(i,j)}else{return e(i)}};var b=("function (err, res) {"+"if (err) { rj(err); } else { rs(res); }"+"}");function h(m,n){var k=[];for(var l=0;l<n;l++){k.push("a"+l)}var j=["return function ("+k.join(",")+") {","var self = this;","return new Promise(function (rs, rj) {","var res = fn.call(",["self"].concat(k).concat([b]).join(","),");","if (res &&",'(typeof res === "object" || typeof res === "function") &&','typeof res.then === "function"',") {rs(res);}","});","};"].join("");return Function(["Promise","fn"],j)(f,m)}function e(n){var k=Math.max(n.length-1,3);var l=[];for(var m=0;m<k;m++){l.push("a"+m)}var j=["return function ("+l.join(",")+") {","var self = this;","var args;","var argLength = arguments.length;","if (arguments.length > "+k+") {","args = new Array(arguments.length + 1);","for (var i = 0; i < arguments.length; i++) {","args[i] = arguments[i];","}","}","return new Promise(function (rs, rj) {","var cb = "+b+";","var res;","switch (argLength) {",l.concat(["extra"]).map(function(o,i){return("case "+(i)+":"+"res = fn.call("+["self"].concat(l.slice(0,i)).concat("cb").join(",")+");"+"break;")}).join(""),"default:","args[argLength] = cb;","res = fn.apply(self, args);","}","if (res &&",'(typeof res === "object" || typeof res === "function") &&','typeof res.then === "function"',") {rs(res);}","});","};"].join("");return Function(["Promise","fn"],j)(f,n)}f.nodeify=function(i){return function(){var k=Array.prototype.slice.call(arguments);var m=typeof k[k.length-1]==="function"?k.pop():null;var j=this;try{return i.apply(this,arguments).nodeify(m,j)}catch(l){if(m===null||typeof m=="undefined"){return new f(function(o,n){n(l)})}else{a(function(){m.call(j,l)})}}}};f.prototype.nodeify=function(j,i){if(typeof j!="function"){return this}this.then(function(k){a(function(){j.call(i,null,k)})},function(k){a(function(){j.call(i,k)})})}},function(c,e,b){var i=b(9);var g=[];var j=[];var h=i.makeRequestCallFromTimer(d);function d(){if(j.length){throw j.shift()}}c.exports=a;function a(k){var l;if(g.length){l=g.pop()}else{l=new f()}l.task=k;i(l)}function f(){this.task=null}f.prototype.call=function(){try{this.task.call()}catch(k){if(a.onerror){a.onerror(k)}else{j.push(k);h()}}finally{this.task=null;g[g.length]=this}}},function(b,a,d){var c=d(8);b.exports=c;c.enableSynchronous=function(){c.prototype.isPending=function(){return this.getState()==0};c.prototype.isFulfilled=function(){return this.getState()==1};c.prototype.isRejected=function(){return this.getState()==2};c.prototype.getValue=function(){if(this._81===3){return this._65.getValue()}if(!this.isFulfilled()){throw new Error("Cannot get a value of an unfulfilled promise.")}return this._65};c.prototype.getReason=function(){if(this._81===3){return this._65.getReason()}if(!this.isRejected()){throw new Error("Cannot get a rejection reason of a non-rejected promise.")}return this._65};c.prototype.getState=function(){if(this._81===3){return this._65.getState()}if(this._81===-1||this._81===-2){return 0}return this._81}};c.disableSynchronous=function(){c.prototype.isPending=undefined;c.prototype.isFulfilled=undefined;c.prototype.isRejected=undefined;c.prototype.getValue=undefined;c.prototype.getReason=undefined;c.prototype.getState=undefined}},function(c,b,f){var e={};var g=["appear","disappear"];var a=f(17);var d=a(function(h){DPApp._doSendMessage(h.method,h.args,h.callback)});c.exports={_dequeueTimeout:null,dequeue:function(){var h=this;setTimeout(function(){DPApp&&DPApp.log&&DPApp.log("Dequeue");clearTimeout(this._dequeueTimeout);h._dequeueTimeout=null;d.dequeue()},0)},ready:function(i){var h=this;this._send("ready",{success:function(){h._isReady=true;
i()}})},openScheme:function(j){var i=j.url;var h=j.extra;if(h){i+="?"+this._convertUrlParams(h);delete j.extra;j.url=i}this._send("openScheme",j)},_sendMessage:function(k,i,j){var h=this;d.push({method:k,args:i,callback:j});this._dequeueTimeout=setTimeout(function(){h.dequeue()},1000)},_generateCallbackId:function(){var h=Math.floor(Math.random()*1000);var i=(+new Date()).toString();var j=i.substr(i.length-5,5);return +(j+""+h)},_generateCallbackName:function(h){return"DPApp_callback_"+h},_doSendMessage:function(m,h,l){var k=l&&typeof l=="function";this.log("调用方法",m,h);var j=k?this._generateCallbackId():0;if(k){window[this._generateCallbackName(j)]=l}if(!h||typeof h!=="object"){h={}}h.callbackId=j;h=JSON.stringify(h);var i="js://_?method="+m+"&args="+encodeURIComponent(h)+"&callbackId="+j;this.log("创建iframe "+m,"callbackId:"+j);this._createIframe(i)},_createNode:function(k,h){var i=document.createElement(h);i.style.display="none";function j(){i.onload=i.onerror=null;i.parentNode&&i.parentNode.removeChild(i)}i.onload=i.onerror=j;setTimeout(j,5000);i.src=k;document.body.appendChild(i)},_createIframe:function(h){this._createNode(h,"iframe")},_send:function(h,l){l=l||{};var p=this;var m=l.success;var q=l.fail;var i=l.handle;var j=function(r){p.log("调用失败 "+h,r);q&&q.call(p,r)};var o=function(r){p.log("调用成功 "+h,r);m&&m.call(p,r)};var k=function(r){p.log("回调 "+h,r);i&&i.call(p,r)};var n=(m||q||i)?function(r){var s=r.status;if(r.result!="next"){delete r.result}if(s=="success"){o&&o(r)}else{if(s=="action"){k&&k(r)}else{j&&j(r)}}}:null;if(this._isReady){this._sendMessage(h,l,n)}else{this.ready(function(){this._sendMessage(h,l,n)})}},_convertUrlParams:function(k){var h=[];for(var j in k){h.push(j+"="+encodeURIComponent(k[j]))}return h.join("&")},_sanitizeAjaxOpts:function(i){i.method=i.method||"get";i.data=i.data||"";var h=i.url;var j=i.data;if(i.method=="get"){var l=[];for(var k in j){if(j.hasOwnProperty(k)&&(j[k]||j[k]===0)){l.push(k+"="+encodeURIComponent(j[k]))}}if(l.length){h+=h.indexOf("?")==-1?"?":"&";h+=l.join("&")}i.url=h;delete i.data}return i},_parseFeed:function(i){var h;if(!i){return 255}else{if(i.constructor.toString().indexOf("Array")>=0){h=[0,0,0,0,0,0,0,0];i.forEach(function(j){h[7-j]=1});return parseInt(h.join(""),2)}}},_transModel:function(m,n){if(!m){return n}var l={};function k(r){var p=function(w){var v=0,t,u,s;if(w.length==0){return v}for(t=0,s=w.length;t<s;t++){u=w.charCodeAt(t);v=((v<<5)-v)+u;v|=0}return v};var q=p(r);return"0x"+((65535&q)^(q>>>16)).toString(16)}function i(p){p.forEach(function(q){l[k(q)]=q})}function j(p){return Object.prototype.toString.call(p)=="[object Array]"}function h(p){return Object.prototype.toString.call(p)=="[object Object]"}function o(q){if(h(q)){delete q.__name;for(var p in q){var r;if(l[p]){r=q[l[p]]=q[p];o(r);delete q[p]}}}else{if(j(q)){q.forEach(function(s){o(s)})}}return q}m.forEach(function(p){l[k(p)]=p});return o(n)},_capital:function(h){return h.slice(0,1).toUpperCase()+h.slice(1)},subscribe:function(l){var j=this;var k=l.action;var n=l.success;var m=l.handle;var i;function h(p){e[k]&&e[k].length&&e[k].forEach(function(q){q&&q(p)})}function o(){if(i){j[i]=h;l.success&&l.success()}}if(e[k]){l.success&&l.success();e[k].push(m)}else{if(g.indexOf(k)!=-1){i="on"+j._capital(k);if(k=="scroll"){this._send(i,{success:o})}else{o()}}else{this._send("subscribe",{action:k,success:l.success,handle:h})}e[k]=[m]}},unsubscribe:function(i){var h=i.action;var n=i.success;var k=i.handle;var p=this;var l=e[h]?e[h].indexOf(k):-1;function j(){p[m]=NOOP}if(l!=-1){e[h].splice(l,1);n&&n();if(!e[h].length){e[h]=null}}else{if(!k){e[h]=null}}if(!e[h]){if(g.indexOf(h)!=-1&&after7_6){var o="off"+p._capital(h);var m="on"+p._capital(h);if(h=="scroll"){this._send(o,{success:j})}else{j()}}else{this._send("unsubscribe",{action:h,success:n})}}},getUA:function(){},callback:function(i,k){var j=window;var h=this._generateCallbackName(i);var l=window[h];if(l){this.log("触发回调 ","callbackId:"+i);setTimeout(function(){l&&l.call(self,k)});if(k.result=="complete"||k.result=="error"){j[h]=null;delete j[h]}}}}},function(c,b){var a=c.exports=function(g){var d=null;var e=null;var f={timeout:null,running:false,tasks:[],push:function(i,h){var j=h||function(k){};f.tasks.push({data:i,callback:j});setTimeout(function(){f.process()},0)},dequeue:function(){if(e){e()}else{f.running=false}},process:function(){if(f.tasks.length&&!f.running){var h=f.tasks.shift();f.running=true;e=function(){f.running=false;h.callback(h.data);f.process()};d=h.data;g(h.data,e)}}};return f}},function(b,a){b.exports={_iOSNetworkType:function(c){var g;var d={kSCNetworkReachabilityFlagsTransientConnection:1<<0,kSCNetworkReachabilityFlagsReachable:1<<1,kSCNetworkReachabilityFlagsConnectionRequired:1<<2,kSCNetworkReachabilityFlagsConnectionOnTraffic:1<<3,kSCNetworkReachabilityFlagsInterventionRequired:1<<4,kSCNetworkReachabilityFlagsConnectionOnDemand:1<<5,kSCNetworkReachabilityFlagsIsLocalAddress:1<<16,kSCNetworkReachabilityFlagsIsDirect:1<<17,kSCNetworkReachabilityFlagsIsWWAN:1<<18};
var f=+c.type;var h=c.subType;var e;function i(j){switch(j){case"CTRadioAccessTechnologyGPRS":case"CTRadioAccessTechnologyEdge":case"CTRadioAccessTechnologyCDMA1x":return"2g";case"CTRadioAccessTechnologyLTE":return"4g";case"CTRadioAccessTechnologyWCDMA":case"CTRadioAccessTechnologyHSDPA":case"CTRadioAccessTechnologyHSUPA":case"CTRadioAccessTechnologyCDMA1x":case"CTRadioAccessTechnologyCDMAEVDORev0":case"CTRadioAccessTechnologyCDMAEVDORevA":case"CTRadioAccessTechnologyCDMAEVDORevB":case"CTRadioAccessTechnologyeHRPD":return"3g"}}if((f&d.kSCNetworkReachabilityFlagsReachable)==0){return"none"}if((f&d.kSCNetworkReachabilityFlagsConnectionRequired)==0){e="wifi"}if((f&d.kSCNetworkReachabilityFlagsConnectionOnDemand)!=0||(f&d.kSCNetworkReachabilityFlagsConnectionOnTraffic)!=0){if((f&d.kSCNetworkReachabilityFlagsInterventionRequired)==0){e="wifi"}}if((f&d.kSCNetworkReachabilityFlagsIsWWAN)==d.kSCNetworkReachabilityFlagsIsWWAN){e=i(h)}return e},_androidNetworkType:function(c){var d=c.type;var e=c.subType;if(d==0){switch(e){case 1:case 2:case 4:case 7:case 11:return"2g";case 3:case 5:case 6:case 8:case 9:case 10:case 12:case 14:case 15:return"3g";case 13:return"4g"}}if(d==1){return"wifi"}else{return"none"}},getNetworkType:function(d){var c=this;var e=d.success;this._send("getNetworkType",{success:function(f){var g=c._osUA;var h;switch(g.name){case"iphone":h=this._iOSNetworkType(f);break;case"android":h=this._androidNetworkType(f);break}e&&e({networkType:h,raw:{type:f.type,subType:f.subType}})},fail:d.fail})}}},function(b,a){b.exports=function(){var c={};Array.prototype.forEach.call(arguments,function(d){for(var e in d){if(d.hasOwnProperty(e)){c[e]=d[e]}}});return c}},function(a,d){var c=/dp\/com\.dianping\.[\w\.]+\/([\d\.]+)/;var g=function(l){var j;var m=/MApi/;var k=l.match(c);if(k){j=k[1]}else{if(m.test(l)){j="7.0.0"}else{j="web"}}return j};var h=function(l){var k=/android/i;var j=/ipad|iphone/i;if(k.test(l)){return"android"}else{if(j.test(l)){return"ios"}}};var f=function(k){if(k.match(c)){var l=/adapter\/([\d\.]+)/;var j=k.match(l);if(j){return j[1]}}};var i=function(j){return f(j)||g(j)};var b=g(navigator.userAgent);var e=h(navigator.userAgent);a.exports={appVersion:b,getAppVersion:g,osName:e,getOSName:h,getWebviewVersion:i,actionMapping:function(j){return function(k){this._send(j,k)}}}},function(b,a){b.exports=["getRequestId","isInstalledApp","getNetworkType","getVersion","getUserInfo","login","updateAccount","logout","getCityId","getLocation","getCity","setPullDown","stopPullDown","openScheme","jumpToScheme","closeWindow","getContactList","sendSMS","bindPhone","ajax","setSpotlight","store","retrieve","downloadImage","chooseImage","previewImage","playVoice","share","publish","subscribe","unsubscribe","alert","prompt","confirm","actionSheet","setTitle","setBackgroundColor","setNavigationBarHidden","setScrollEnabled","setLLButton","setLRButton","setRLButton","setRRButton","setBouncesEnabled","getCX"]},function(c,a){var d=window.onerror;var b="http://114.80.165.63/broker-service/api/js";window.onerror=function(j,i,f,h,g){var l=encodeURIComponent;var k=Date.now();(new window.Image).src=b+"?error="+l(j)+"&v=1"+"&data="+l(g&&g.stack?g.stack:"")+"&url="+l(location.href)+"&file="+l(i)+"&line="+l(f)+"&col="+l(h)+"&timestamp="+k;d&&d(j,i,f,h,g)}},function(c,b,d){var a=d(20);c.exports={appVersion:"7.0",_parseFeed:function(g){var e;if(!g){return 255}else{if(g.constructor.toString().indexOf("Array")>=0){e=[0,0,0,0,0,0,0,0];g.forEach(function(f){e[f]=1});return parseInt(e.join(""),2)}}},share:function(e){e.feed=this._parseFeed(e.feed);e.url=this._tidyUrlParams(e.url);this._sendMessage("share",e)},initShare:function(f){var h=f.success;var e=f.fail;var g="dpshare://_?content=";g+=encodeURIComponent(JSON.stringify({title:f.title,desc:f.desc,image:f.image,feed:this._parseFeed(f.feed),url:f.url}));this.shareCallback=function(i){if(i.status=="success"){h&&h(i)}else{e&&e(i)}};this._createIframe(g)},getUA:function(g){var h=g&&g.success;var e=navigator.userAgent.match(/MApi\s[\w\.]+\s\([\w\.\d]+\s([\d\.]+)/)[1];var f={platform:"dpapp",appName:"dianping",appVersion:e,osName:this._osUA.name,osVersion:this._osUA.version};h&&h(f);return f},ready:function(e){this._isReady=true;e()},pay:function(j){var g=this;var i=j.payType;var l=j.success;var f=j.fail;var e=j.cx;function k(m,n){DPApp.ajax({url:"http://api.p.dianping.com/payorder.pay",data:m,keys:["Content"],success:function(o){n(null,o)},fail:function(){n("fail payorder")}})}function h(n){var q=1;var p=7;var m="5:1:null#219#0";var o="11:1:null#217#0";if(n==p){paymentTool=o}else{paymentTool=m}return paymentTool}k({token:j.token,orderid:j.orderId,paymenttool:h(i),cx:e},function(m,n){if(m){return f&&f(m)}g._sendMessage("pay",{paytype:i,paycontent:n.Content},function(o){if(o.payresult){l&&l(o)}else{f&&f(o)}})})},uploadImage:function(f){var e=f.fail;var g=f.handle;this._sendMessage("uploadImage",f,function(h){var i=h.status;if(i=="fail"){e&&e(h);return}else{g&&g(h)}})},ajax:function(e){e=this._sanitizeAjaxOpts(e);
var f=e.success;e.success=function(h){var g=JSON.parse(h.mapiResult);g=this._transModel(e.keys,g);f(g)};this._send("mapi",e)},getCX:a.actionMapping("getCX"),getContactList:a.actionMapping("getContactList"),getRequestId:a.actionMapping("getRequestId"),closeWindow:a.actionMapping("close_web"),getUserInfo:a.actionMapping("getUserInfo"),getCity:a.actionMapping("getCityId"),getCityId:a.actionMapping("getCityId"),getLocation:a.actionMapping("getLocation")}},function(b,f,a){var h=a(20);var c=a(1);var j=a(23);var d=["setLLButton","setLRButton","setRLButton","setRRButton","setTitle","sendSMS","publish","closeWindow"];var g={};var e=["appear","disappear","scroll"];function k(n){var m="on"+c._captal(n);if(h.osName=="android"&&h.appVersion=="7.6.0"&&/appear|disappear/.test(n)){m=n}return m}var i=(function(){var o=navigator.userAgent;var m=o.match(/dp\/[\w\.\d]+\/([\d\.]+)/);var n=m&&m[1];var r=o.match(/dp\/(com\.dianping\.\w+)/);var s=r&&r[1];var q=o.match(/adapter\/([\d\.]+)/);var p=q&&q[1];return function(u){var v=u&&u.success;var t={platform:"dpapp",appName:"dianping",packageId:s,appVersion:n,osName:c._osUA.name,osVersion:c._osUA.version,adapterVersion:p};v&&v(t);return t}})();var l=b.exports={appVersion:"7.1.0",pay:j.pay,uploadImage:j.uploadImage,getUA:i,ready:function(n){var m=this;this._send("ready",{success:function(){m._isReady=true;n()}})},login:function(n){var m=this;var p;function o(q){m.getUserInfo({success:q})}o(function(r){if(r.token){n.success&&n.success(r)}else{var u="loginSuccess";var q="appear";var s=function(){o(function(v){p=v});m.unsubscribe({action:u,handle:s})};m.subscribe({action:u,handle:s});var t=function(){o(function(v){if(v&&v.token){n.success&&n.success(v)}else{n.fail&&n.fail()}});m.unsubscribe({action:q,handle:t})};m.subscribe({action:q,handle:t});m.openScheme({url:"dianping://login"})}})},updateAccount:function(o){o=o||{};var n=this;var p=document.cookie.match(/dper=\w+/);if(p){p=p[0].split("=")[1]}if(o.dper){p=o.dper}if(!p){return o.fail&&o.fail("Missing dper")}var m=function(t,r){var q=0;function s(){n.getUserInfo({success:function(u){if(u.token){t&&t(u)}else{if(q>5){r&&r()}else{q++;setTimeout(function(){s()},100)}}}})}s()};n.ajax({url:"http://m.api.dianping.com/mlogin/convertdper.api",data:{dper:p},keys:["Token","NewToken"],success:function(q){var r=n.getUA();if(n.Semver.gte(r.appVersion,"7.5.0")){n._send("updateAccount",{token:q.Token,newtoken:q.NewToken,success:function(){n.getUserInfo({success:o.success})},fail:o.fail})}else{n._send("loginsuccess",{token:q.Token,newtoken:q.NewToken});m(o.success,o.fail)}},fail:o.fail})},_parseFeed:function(n){var m;if(!n){return 255}else{if(n.constructor.toString().indexOf("Array")>=0){m=[0,0,0,0,0,0,0,0];n.forEach(function(o){m[7-o]=1});return parseInt(m.join(""),2)}}},share:function(m){m.feed=this._parseFeed(m.feed);m.url=this._tidyUrlParams(m.url);this._send("share",m)},initShare:function(n){var m=this;this.setRRButton({icon:"H5_Share",handle:function(){n.handle&&n.handle();m.share({title:n.title,desc:n.desc,content:n.content,image:n.image,feed:n.feed,url:n.url,success:n.success,fail:n.fail})}})},subscribe:function(o){var n=o.action;var p=o.handle;function m(q){g[n]&&g[n].length&&g[n].forEach(function(r){r&&r(q)})}if(g[n]){o.success&&o.success();g[n].push(p)}else{this._send("subscribe",{action:n,success:o.success,handle:m});g[n]=[p]}},unsubscribe:function(o){var n=o.action;var q=o.success;var p=o.handle;var m=g[n]?g[n].indexOf(p):-1;if(m!=-1){g[n].splice(m,1);q&&q();if(!g[n].length){g[n]=null}}else{if(!p){g[n]=null}}if(!g[n]){this._send("unsubscribe",{action:n,success:q})}},openScheme:function(o){var n=o.url;var m=o.extra;if(m){n+="?"+this._convertUrlParams(m);delete o.extra;o.url=n}this._send("openScheme",o)}};d.forEach(function(m){l[m]=h.actionMapping(m)});e.forEach(function(m){l[k(m)]=function(){}})},function(b,a){b.exports={appVersion:"7.2.0",jumpToScheme:function(e){var d=e.url;var c=e.extra;if(c){d+="?"+this._convertUrlParams(c);delete e.extra;e.url=d}e.toHome=!!e.toHome?1:0;this._send("jumpToScheme",e)},publish:function(d){var e=this._getBizName(d);var c=["phoneChanged","AccountBindChange"];if(e){if(c.indexOf(d.action)==-1){d.action=e+":"+d.action}this._send("publish",d)}}}},function(c,b,d){var a=d(20);c.exports={appVersion:"7.5.0",store:function(e){var f=this._getBizName(e);if(f){e.key=f+":"+e.key;this._send("store",e)}},retrieve:function(e){var f=this._getBizName(e);if(e.key.indexOf(":")===-1){e.key=f+":"+e.key}this._send("retrieve",e)},setBackgroundColor:a.actionMapping("setBackgroundColor")}},function(e,d,g){var c=g(20);var b=g(1);var f={};var h=["appear","disappear","scroll"];function a(j){var i="on"+b._captal(j);if(c.osName=="android"&&c.appVersion=="7.6.0"&&/appear|disappear/.test(j)){i=j}return i}e.exports={appVersion:"7.6.0",isInstalledApp:c.actionMapping("isInstalledApp"),subscribe:function(m){var k=this;var l=m.action;var n=m.handle;var j;function i(p){f[l]&&f[l].length&&f[l].forEach(function(q){q&&q(p)})}function o(){if(j){window.DPApp&&(window.DPApp[a(l)]=i);
m.success&&m.success()}}if(f[l]){m.success&&m.success();f[l].push(n)}else{if(h.indexOf(l)!==-1){j="on"+k._captal(l);if(l=="scroll"){this._send(j,{success:o})}else{o()}}else{this._send("subscribe",{action:l,success:m.success,handle:i})}f[l]=[n]}},unsubscribe:function(j){var i=j.action;var o=j.success;var l=j.handle;var q=this;var m=f[i]?f[i].indexOf(l):-1;function k(){q[n]=function(){}}if(m!=-1){f[i].splice(m,1);o&&o();if(!f[i].length){f[i]=null}}else{if(!l){f[i]=null}}if(!f[i]){if(h.indexOf(i)!==-1){var p="off"+q._captal(i);var n="on"+q._captal(i);if(i=="scroll"){this._send(p,{success:k})}else{k()}}else{this._send("unsubscribe",{action:i,success:o})}}},}},function(e,c,f){var b=f(20);var d=["alert","confirm","actionSheet","prompt","setPullDown","stopPullDown","downloadImage"];var a={appVersion:"7.8.0"};d.forEach(function(h){var g=b.actionMapping(h);a[h]=g});a.prompt=function(g){if(!g.placeholder){g.placeholder=""}this._send("prompt",g)};e.exports=a},function(d,c,f){var b=f(20);var e=f(30);var a=f(1);d.exports={appVersion:"7.9.1",setNavigationBarHidden:b.actionMapping("setNavigationBarHidden"),chooseImage:function(g){g=g||{};g.count=(!g.count||g.count>9||g.count<1)?9:g.count;this._send("chooseImage",g)},uploadImage:function(j){var l=j.success;var g=j.fail;var k=j.handle;var i=this.getUA();var h=this;if(j.localId||j.localIds){if(a.Semver.gte(i.adapterVersion||i.appVersion,"7.9.1")){if(j.localIds){(function(n){var o={};var m=[];e.mapSeries(n,function(q,p){h._send("uploadPhoto",{localId:q,success:function(r){o[q]=r.picKey;m.push({localId:q,picKey:r.picKey});p(null)},fail:function(r){p(r)}})},function(p){if(p){g&&g(p)}else{l&&l({picKeys:o,photoInfos:m})}})})(j.localIds)}else{this._send("uploadPhoto",j)}}else{g({errMsg:"ERR_NOT_IMPLEMENTED"})}}else{this._sendMessage("uploadImage",j,function(m){var n=m.status;if(n=="fail"){g&&g(m);return}else{k&&k(m)}})}},}},function(b,a){a.mapSeries=function(d,h,i){var f=d.length;var g=0;var e=[];function c(k,j){if(k){return i(k)}g++;e.push(j);if(g!==f){h(d[g],c)}else{i(null,e)}}h(d[g],c)}},function(c,b,d){var a=d(20);c.exports={appVersion:"7.9.4",setSpotlight:function(e){if(!e.webpageURL){return}if(!e.scheme){e.scheme="dianping://web?url="+encodeURIComponent(e.webpageURL)}this._send("setSpotlight",e)},playVoice:a.actionMapping("playVoice")}},function(b,a){b.exports={appVersion:"7.9.6",logout:function(d){var c;if(d.type===1){c="dianping://me"}else{if(d.type===2){c="dianping://home"}}if(c){d.success=function(){this.openScheme({url:c})}}this._send("logout",d)}}},function(c,b,d){var a=d(20);c.exports={appVersion:"8.0.0",setScrollEnabled:a.actionMapping("setScrollEnabled"),setBouncesEnabled:a.actionMapping("setBouncesEnabled"),bindPhone:a.actionMapping("bindPhone"),pay:a.actionMapping("pay")}},function(d,c,e){var b=e(20);var a={appVersion:"8.0.4",thirdLogin:function(g){var h=g.type;var f;switch(h){case 1:f="http://m.dianping.com/auth/app?ft=15&sso=true";break;case 2:f="http://m.dianping.com/auth/app?ft=6&sso=true&redir=";break;case 3:f="http://m.dianping.com/auth/app?ft=5&ssp=true&redir=";break;case 4:f="http://m.dianping.com/auth/app?ft=2&source=1&sso=true&redir=";break}this.openScheme({url:"dianping://loginweb?url="+encodeURIComponent(f)+"&isFromNative=true",})},getCX:function(f){var g=f.success;f.success=function(h){if(h.fingerprint){h.cx=h.fingerprint}g(h)};this._send("getCX",f)},uploadImage:function(g){var i=g.success;var f=g.fail;var h=g.handle;if(g.localId||g.localIds){if(g.localId){g.localIds=[g.localId];delete g.localId}g.success=function(k){var l={};var j;if(k.ret){k.ret.forEach(function(n,m){j=n.localId||g.localIds[m];l[j]=n.picKey});k.photoInfos=k.ret;delete k.ret}k.picKeys=l;i(k)};this._send("uploadPhoto",g)}else{this._sendMessage("uploadImage",g,function(j){var k=j.status;if(k=="fail"){f&&f(j);return}else{h&&h(j)}})}}};if(b.osName==="ios"){a.setStatusBarStyle=function(f){if(f.style===undefined){f.style=0}this._send("setStatusBarStyle",f)}}d.exports=a}]);