'use strict';

var debug;
if (process.env.NODE_ENV !== 'production') {
    debug = require('debug')('hbnb:module:account:getUser');
}

var _invoke = require('../invoke');

/**
 * 获取用户登录信息
 *
 * 用户已登录时 resolve，用户未登录 reject
 *
 * @memberof flight
 * @static
 * @name getUser
 * @return {Promise<user | err>}
 * @example
 *  hbnb.flight.getUser()
 *      .then(function(user) {
 *          user = {
 *              userId: 1234567,
 *              userName: 'name is string',
 *              userToken: 'token is string'
 *          }
 *      })
 *      .catch(function(err) {
 *          err = {
 *              message: "用户未登录美团",
 *              status: -1
 *          }
 *      });
 */

module.exports = function(cb, eb) {
    var p = new Promise(function(resolve, reject) {
        _invoke('flight', 'get_user', {
            callback: function(user) {
                if (process.env.NODE_ENV !== 'production') {
                    debug('user is %j', user, user);
                }
                resolve(user);
            },
            errback: function(msg) {
                if (process.env.NODE_ENV !== 'production') {
                    debug('no user info, %j', msg);
                }
                reject(msg);
            }
        });
    });
    return p;
};
