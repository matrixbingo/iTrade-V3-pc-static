!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t(require("react"));else if("function"==typeof define&&define.amd)define(["react"],t);else{var r=t("object"==typeof exports?require("react"):e.React);for(var n in r)("object"==typeof exports?exports:e)[n]=r[n]}}(this,function(e){return function(e){function t(n){if(r[n])return r[n].exports;var o=r[n]={exports:{},id:n,loaded:!1};return e[n].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,t,r){e.exports=r(1)},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}var o=r(2),a=n(o);r(!function(){var e=new Error('Cannot find module "../css/index.less"');throw e.code="MODULE_NOT_FOUND",e}()),window.Eagleui?Eagleui.MultiDropDown=a["default"]:window.MultiDropDown=a["default"],e.exports=a["default"]},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),c=r(3),u=n(c),l=function(e){function t(r,n){o(this,t),e.call(this,r,n),this.state={dropDownBranch:[],dropDownQueue:[],partSelectBranch:{},formGroup:[],title:r.title,keyName:r.keyName,leafName:r.leafName},this.formData=this.state.formGroup,this.treePathMap={};var a=[],i=[],c={};this.generateTreePathMap(this.treePathMap,this.props,a,i,c),this.state.formGroup=a,this.state.dropDownBranch=i,this.state.partSelectBranch=c,this.state.title=this.renderTitle(a)||this.props.title}return a(t,e),t.prototype.generateTreePathMap=function(e,t,r,n,o){var a=t.dropDownData,i=t.selected,c={};if(i){var u=i.split(",");u.forEach(function(e){c[e]=!0})}this.climbTree("-1",a,e,c,r),this.selectActiveBranchNode({typeId:"-1",children:a},n,c),this.findPartSelectBranchNode({typeId:"-1",children:a},o,c),n.forEach(function(e){o[e.typeId]&&delete o[e.typeId]})},t.prototype.findPartSelectBranchNode=function(e,t,r){var n=this,o=e.children?e.children:[];if(0==o.length)return!!r[e.typeId];for(var a=!1,i=0;i<o.length;i++)a=n.findPartSelectBranchNode(o[i],t,r)||a;return a&&e.typeId!=-1&&(t[e.typeId]=!0),a},t.prototype.selectActiveBranchNode=function(e,t,r){var n=this,o=e.children?e.children:[];if(0==o.length)return!!r[e.typeId];for(var a=!0,i=0;i<o.length;i++)a=n.selectActiveBranchNode(o[i],t,r)&&a;return a&&e.typeId!=-1&&t.push(e),a},t.prototype.climbTree=function(e,t,r,n,o){var a=this;t&&t.length&&t.forEach(function(t,i){var c=e+","+i,u=t.children;r[t.typeId]=c,n&&n[t.typeId]&&o.push(t),u&&u.length&&a.climbTree(c,u,r,n,o)})},t.prototype.getParams=function(){return this.state.formGroup.map(function(e){return e.typeId})},t.prototype.renderTitle=function(e){var t=this.state.keyName;return e&&e.reduce(function(e,r){return e+r[t]+";"},"")},t.prototype.checkboxHandler=function(e){var t=this.state.formGroup,r=this.state.dropDownBranch,n=t.indexOf(e);n>-1?t.splice(n,1):t.push(e),this.updateParentNode(e,r,t);var o=t.map(function(e){return e.typeId});this.props.onChange&&this.props.onChange(o.join(","))},t.prototype.renderList=function(e,t,r,n,o){var a=this,i=null,c=this.state,l=c.formGroup,p=c.keyName,s=c.dropDownBranch,d=c.partSelectBranch;return i="branch"==e?u["default"].createElement("li",{key:o+t.typeId,title:t[p],className:n==r?"on":"",onClick:function(){a.branchCheckBoxHandler(t)}},u["default"].createElement("div",{className:"multi-list-checkbox"},u["default"].createElement("b",{className:(s.indexOf(t)>=0?"active":"")+(d[t.typeId]?" part-select":"")})),u["default"].createElement("div",{className:"multi-drop-down-list-content",onMouseOver:function(){a.calculateNextMenuTree(o,n)}},t[p]),u["default"].createElement("em",null)):u["default"].createElement("li",{title:t[p],className:"multi-drop-down-input",onClick:function(){a.checkboxHandler(t)},key:o+t.typeId},u["default"].createElement("i",{className:l.indexOf(t)<0?"check-box":"check-box active"},u["default"].createElement("b",null)),u["default"].createElement("div",{className:"select-drop-down-check-content"}," ",t[p]))},t.prototype.calculateNextMenuTree=function(e,t){var r=this.state.dropDownQueue;return r=r.slice(0,e),r[e]=t,this.setState({dropDownQueue:r}),r},t.prototype.componentWillReceiveProps=function(e){if(e.dropDownData){var t=[],r=[],n={};this.generateTreePathMap(this.treePathMap,e,t,r,n),this.setState({formGroup:t,title:this.renderTitle(t)||this.props.title,dropDownBranch:r,partSelectBranch:n})}},t.prototype.updateParentNode=function(e,t,r){var n=this.treePathMap,o=this.props.dropDownData,a=[];if(n[e.typeId]){a=n[e.typeId].split(","),a.shift(),a.pop();var i=o,c={typeId:"0"};if(a.length){a.forEach(function(e){c=i[e],i=i[e].children});var u={};t.forEach(function(e){u[e.typeId]=!0}),r.forEach(function(e){u[e.typeId]=!0});var l=e.typeId;if(u[l]){var p=!0;i.forEach(function(e){u[e.typeId]||(p=!1)}),p&&"0"!=c.typeId&&(t.push(c),this.updateParentNode(c,t,r))}else{var s=t.indexOf(c);s>-1&&t.splice(s,1),"0"!=c.typeId&&this.updateParentNode(c,t,r)}}}},t.prototype.branchCheckBoxHandler=function(e){var t=this.state,r=t.dropDownBranch,n=t.formGroup,o=r.slice(),a=n.slice(),i=o.indexOf(e);i>-1?(o.splice(i,1),this.iterateSourceData(e.children,function(e){if(e&&!e.leaf){var t=o.indexOf(e);t>-1&&o.splice(t,1)}else{var t=a.indexOf(e);t>-1&&a.splice(t,1)}})):(o.push(e),this.iterateSourceData(e.children,function(e){if(e&&!e.leaf){var t=o.indexOf(e);t<0&&o.push(e)}else{var t=a.indexOf(e);t<0&&a.push(e)}})),this.updateParentNode(e,o,a);var c=a.map(function(e){return e.typeId});this.props.onChange&&this.props.onChange(c.join(","))},t.prototype.iterateSourceData=function(e,t){var r=function n(e){for(var r=0;r<e.length;r++)t(e[r]),e[r]&&e[r].children&&n(e[r].children)};r(e)},t.prototype.getSourceData=function(e){var t=this.props.dropDownData;return e.reduce(function(e,t){return e[t].children},t)},t.prototype.renderQueuedMenu=function(e){var t=this,r=[];return e.reduce(function(n,o){n.push(o);var a=t.getSourceData.call(t,n);return a&&a.length>0&&r.push(t.renderChildMenu(a,n.length,e)),n},[]),r},t.prototype.renderChildMenu=function(e,t,r){var n=this,o=this.state.leafName,a=r[t],i=u["default"].createElement("ul",{className:"multi-drop-down-list select-drop-down-list",key:t},e&&e.map(function(e,r){return e[o]?n.renderList("leaf",e,a,r,t):n.renderList("branch",e,a,r,t)}));return i},t.prototype.render=function(){var e=this,t=this.props.dropDownData,r=this.state,n=r.dropDownQueue,o=r.title;return u["default"].createElement("div",{className:"question-multi-menu"},u["default"].createElement("div",{className:"question-multi-menu-head",onMouseOver:function(){e.setState({dropDownQueue:[]})}},u["default"].createElement("span",{className:"drop-down-hint"},o),u["default"].createElement("i",{className:"drop-down-arrow"})),t&&t.length>0?u["default"].createElement("div",{className:"question-multi-menu-body"},this.renderChildMenu(t,0,n),this.renderQueuedMenu(n)):null)},i(t,null,[{key:"defaultProps",value:{leafName:"leaf",keyName:"keyName",title:"下拉菜单"},enumerable:!0},{key:"propTypes",value:{keyName:c.PropTypes.string,title:c.PropTypes.string,leafName:c.PropTypes.string},enumerable:!0}]),t}(c.Component);t["default"]=l,e.exports=t["default"]},function(t,r){t.exports=e}])});